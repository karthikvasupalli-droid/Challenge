<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BloodMatch ‚Äî Donation Matching Platform</title>
  <meta name="description" content="Find blood donors nearby with BloodMatch ‚Äî Search, register, and save lives." />

  <!-- Mapbox -->
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css" rel="stylesheet" />

  <style>
    :root {
      --primary: #c62828;
      --muted: #666;
      --bg: #fafafa;
      --card: #fff;
      font-family: 'Inter', system-ui, sans-serif;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: var(--bg); color: #222; overflow-x: hidden; scroll-behavior: smooth; }

    /* Header */
    header {
      background: var(--primary);
      color: white;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 3px 10px rgba(0,0,0,0.25);
    }
    .brand { display: flex; gap: 12px; align-items: center; }
    .brand .logo {
      width: 44px; height: 44px; border-radius: 8px;
      background: rgba(255,255,255,0.2);
      display: flex; align-items: center; justify-content: center;
      font-weight: 700;
    }
    nav a {
      color: white; text-decoration: none;
      margin-left: 18px; font-weight: 600;
      transition: opacity 0.3s;
    }
    nav a:hover { opacity: 0.7; }

    /* Hero */
    .hero {
      background: url('https://images.unsplash.com/photo-1588776814546-ec4a13e679b3?auto=format&fit=crop&w=1600&q=80') center/cover no-repeat;
      min-height: 60vh; display: flex; align-items: center; justify-content: center;
      color: white; text-align: center; padding: 40px 16px; position: relative;
    }
    .hero::after {
      content: ''; position: absolute; inset: 0;
      background: rgba(0,0,0,0.55);
    }
    .hero-content {
      position: relative; z-index: 2; max-width: 800px;
      animation: fadeIn 1.2s ease;
    }
    .hero h1 { font-size: 40px; margin-bottom: 16px; }
    .hero p { font-size: 18px; margin-bottom: 20px; }
    .btn-main {
      background: var(--primary); border: none;
      padding: 14px 24px; border-radius: 10px;
      font-size: 16px; font-weight: 600; color: white;
      cursor: pointer; transition: transform 0.2s, background 0.3s;
    }
    .btn-main:hover { background: #b71c1c; transform: scale(1.05); }

    main { max-width: 1200px; margin: 30px auto; padding: 0 16px; }
    h2 { margin-bottom: 16px; }

    .card {
      background: var(--card); border-radius: 16px;
      padding: 20px; box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      margin-bottom: 20px;
      transition: transform .3s, box-shadow .3s;
    }
    .card:hover { transform: translateY(-4px); box-shadow: 0 10px 20px rgba(0,0,0,0.12); }

    /* Search + Results */
    .search-row { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
    .input, .select, .btn {
      padding: 12px 14px; border-radius: 8px; border: 1px solid #ddd;
      outline: none; font-size: 15px;
    }
    .btn { background: var(--primary); color: white; border: none; cursor: pointer; }
    .btn:hover { background: #b71c1c; }

    .grid {
      display: grid; grid-template-columns: repeat(auto-fill,minmax(260px,1fr));
      gap: 14px;
    }
    .donor {
      display: flex; gap: 12px; align-items: center;
      animation: fadeIn .6s ease;
    }
    .donor img {
      width: 56px; height: 56px; border-radius: 50%; object-fit: cover;
    }
    .donor .meta { flex: 1; }
    .muted { color: var(--muted); font-size: 14px; }

    /* Map */
    #map { width: 100%; height: 400px; border-radius: 16px; margin-top: 12px; }

    footer { margin: 40px auto; max-width: 1100px; padding: 10px 16px; color: var(--muted); text-align: center; }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>

  <header>
    <div class="brand">
      <div class="logo">BM</div>
      <div>
        <div style="font-weight:800">BloodMatch</div>
        <div style="font-size:12px;opacity:.9">Find nearby donors fast</div>
      </div>
    </div>
    <nav>
      <a href="#find">Find Donor</a>
      <a href="#register">Register</a>
      <a href="#mapSection">Map</a>
    </nav>
    <div style="font-size:14px">
      Donors: <strong id="statCount">0</strong>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-content">
      <h1>Donate Blood. Save Lives ‚ù§Ô∏è</h1>
      <p>Join thousands of lifesavers. Search, register, and connect instantly.</p>
      <a href="#find"><button class="btn-main">Find a Donor</button></a>
    </div>
  </section>

  <main>
    <!-- Find Donor Section -->
    <section id="find" class="card">
      <h2>Find Donors</h2>
      <div class="search-row">
        <input id="qCity" class="input" placeholder="Enter city (e.g., Hyderabad)" />
        <select id="qGroup" class="select">
          <option value="">Any blood group</option>
          <option>A+</option><option>A-</option>
          <option>B+</option><option>B-</option>
          <option>O+</option><option>O-</option>
          <option>AB+</option><option>AB-</option>
        </select>
        <button id="btnSearch" class="btn">Search</button>
        <button id="btnReset" class="btn" style="background:#555">Reset</button>
      </div>
      <div id="results" class="grid"></div>
    </section>

    <!-- Register Section -->
    <section id="register" class="card">
      <h2>Register as Donor</h2>
      <form id="donorForm">
        <input id="name" class="input" placeholder="Full Name" required />
        <input id="age" class="input" type="number" min="18" max="65" placeholder="Age" required />
        <select id="bloodGroup" class="select" required>
          <option value="">Blood group</option>
          <option>A+</option><option>A-</option>
          <option>B+</option><option>B-</option>
          <option>O+</option><option>O-</option>
          <option>AB+</option><option>AB-</option>
        </select>
        <input id="city" class="input" placeholder="City" required />
        <input id="phone" class="input" placeholder="Phone" required />
        <button type="submit" class="btn">Register</button>
      </form>
    </section>

    <!-- Map Section -->
    <section id="mapSection" class="card">
      <h2>Donor Map & Heatmap</h2>
      <div id="map"></div>
    </section>
  </main>

  <footer>
    Prototype created for demo purposes. Use backend + secure DB in production.
  </footer>

  <script>
    mapboxgl.accessToken = 'YOUR_MAPBOX_ACCESS_TOKEN'; // replace with real token
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [78.4867, 17.3850],
      zoom: 4
    });

    const DB_KEY = 'bloodmatch_donors_v3';
    function readDB(){ try{ const raw=localStorage.getItem(DB_KEY); return raw?JSON.parse(raw):[] }catch(e){ return [] } }
    function writeDB(arr){ localStorage.setItem(DB_KEY,JSON.stringify(arr)) }
    function uid(){ return Date.now()+Math.floor(Math.random()*999) }

    const donorsDemo = [
      {id:1,name:'Ravi Kumar',age:30,blood:'O+',city:'Hyderabad',coords:[78.4867,17.3850],phone:'+91-90000-0001',img:'https://randomuser.me/api/portraits/men/32.jpg'},
      {id:2,name:'Ananya Singh',age:25,blood:'B+',city:'Pune',coords:[73.8567,18.5204],phone:'+91-90000-0002',img:'https://randomuser.me/api/portraits/women/44.jpg'},
      {id:3,name:'Maya Verma',age:28,blood:'O-',city:'Bengaluru',coords:[77.5946,12.9716],phone:'+91-90000-0003',img:'https://randomuser.me/api/portraits/women/36.jpg'},
      {id:4,name:'Karan Patel',age:40,blood:'AB+',city:'Ahmedabad',coords:[72.5714,23.0225],phone:'+91-90000-0004',img:'https://randomuser.me/api/portraits/men/54.jpg'}
    ];

    function renderResults(list){
      const resultsEl=document.getElementById('results');
      resultsEl.innerHTML='';
      if(!list.length){
        resultsEl.innerHTML='<div class="muted" style="grid-column:1/-1">No donors found.</div>';
        return;
      }
      list.forEach(d=>{
        const el=document.createElement('div');el.className='card donor';
        el.innerHTML=`
          <img src="${d.img||'https://via.placeholder.com/56'}" alt="donor" />
          <div class="meta">
            <div style="font-weight:700">${d.name}</div>
            <div class="muted">${d.city} ‚Ä¢ ${d.blood}</div>
            <div>üìû ${d.phone}</div>
          </div>`;
        resultsEl.appendChild(el);
      })
      updateMap(list);
    }

    function updateStats(){
      const db=readDB();
      document.getElementById('statCount').textContent=db.length;
    }

    function updateMap(donors){
      if(map.getSource('donors')){
        map.removeLayer('donors-heat'); map.removeSource('donors');
      }
      const geojson={type:'FeatureCollection',features:donors.map(d=>({type:'Feature',geometry:{type:'Point',coordinates:d.coords},properties:{title:d.name}}))};
      map.addSource('donors',{type:'geojson',data:geojson});
      map.addLayer({id:'donors-heat',type:'heatmap',source:'donors',paint:{'heatmap-weight':1,'heatmap-intensity':1,'heatmap-radius':30,'heatmap-opacity':0.6}});
    }

    document.getElementById('btnSearch').addEventListener('click',()=>{
      const city=document.getElementById('qCity').value.toLowerCase();
      const group=document.getElementById('qGroup').value;
      let data=readDB();
      if(city) data=data.filter(d=>d.city.toLowerCase().includes(city));
      if(group) data=data.filter(d=>d.blood===group);
      renderResults(data);
    });

    document.getElementById('btnReset').addEventListener('click',()=>{renderResults(readDB())});

    document.getElementById('donorForm').addEventListener('submit',e=>{
      e.preventDefault();
      const name=document.getElementById('name').value;
      const age=parseInt(document.getElementById('age').value,10);
      const blood=document.getElementById('bloodGroup').value;
      const city=document.getElementById('city').value;
      const phone=document.getElementById('phone').value;
      const coords=[78.4867,17.3850];
      const img=`https://randomuser.me/api/portraits/${age%2===0?'men':'women'}/${Math.floor(Math.random()*80)}.jpg`;
      const db=readDB();
      db.push({id:uid(),name,age,blood,city,phone,coords,img});
      writeDB(db); updateStats(); renderResults(db);
      e.target.reset();
    });

    (function init(){
      if(!readDB().length){ writeDB(donorsDemo) }
      renderResults(readDB());
      updateStats();
    })();
  </script>
</body>
</html>
